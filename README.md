# Defile de l'Ecluse - Bird Migration Forecasts

[![python](https://img.shields.io/badge/-Python_3.8_%7C_3.9_%7C_3.10-blue?logo=python&logoColor=white)](https://github.com/pre-commit/pre-commit)
[![pytorch](https://img.shields.io/badge/PyTorch_2.0+-ee4c2c?logo=pytorch&logoColor=white)](https://pytorch.org/get-started/locally/)
[![lightning](https://img.shields.io/badge/-Lightning_2.0+-792ee5?logo=pytorchlightning&logoColor=white)](https://pytorchlightning.ai/)
[![hydra](https://img.shields.io/badge/Config-Hydra_1.3-89b8cd)](https://hydra.cc/)

This work is based on [lightning-hydra-template](https://github.com/ashleve/lightning-hydra-template/)

## Project Structure

The directory structure of new project looks like this:

```
├── configs                   <- Hydra configs
│   ├── callbacks                <- Callbacks configs
│   ├── data                     <- Data configs
│   ├── debug                    <- Debugging configs
│   ├── experiment               <- Experiment configs
|   ├── export                   <- Export configs
│   ├── extras                   <- Extra utilities configs
│   ├── hparams_search           <- Hyperparameter search configs
│   ├── hydra                    <- Hydra configs
│   ├── logger                   <- Logger configs
│   ├── model                    <- Model configs
│   ├── paths                    <- Project paths configs
│   ├── trainer                  <- Trainer configs
│   │
│   ├── eval.yaml             <- Main config for evaluation
|   ├── predict.yaml          <- Main config for prediction
│   └── train.yaml            <- Main config for training
│
├── data                   <- Project data
|   ├── count               <- All raptor count data
│   └── era5                <- Environemental variable csv data
│
├── logs                   <- Logs generated by hydra and lightning loggers
│
├── models                 <- Trained models
│
├── notebooks              <- Jupyter notebooks. Naming convention is a number (for ordering),
│                             the creator's initials, and a short `-` delimited description,
│                             e.g. `1.0-jqp-initial-data-exploration.ipynb`.
│
├── prod                   <- Production model
│
├── scripts                <- Shell scripts
│
├── src                    <- Source code
│   ├── data                     <- Data scripts
│   ├── export                   <- Export scripts
│   ├── models                   <- Model scripts
│   ├── utils                    <- Utility scripts
│   │
│   ├── eval.py                  <- Run evaluation
│   ├── predict.py               <- Run prediction
│   └── train.py                 <- Run training
│
├── .gitignore                <- List of files ignored by git
├── .pre-commit-config.yaml   <- Configuration of pre-commit hooks for code formatting
├── .project-root             <- File for inferring the position of project root directory
├── environment.yaml          <- File for installing conda environment
└── README.md
```

## Quickstart

```bash
# clone project
git clone https://github.com/AmedeeRoy/defile-migration-forecast
cd defile

# create conda environment with required dependencies
conda env create --file=environment.yaml

# Activate the environment
conda activate defile-env
```

## How to use

<details>
<summary><b>Train/Evaluate a model with default config</b></summary>

```bash
# train with default config (see `configs/train.yaml` and `configs/data/defile.yaml`)
python src/train.py

# eval with default config
python src/eval.py
```

</details>

<details>
<summary><b>Override default config</b></summary>

```bash
# change existing parameters
python src/train.py data.species="Red Kite" data.years="[2014,2015,2016,2017,2018,2019,2020,2021,2022,2023]"
```
 
</details>
